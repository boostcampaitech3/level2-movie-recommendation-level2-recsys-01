# Movie Recommendation

## ğŸ‘‹ íŒ€ì› ì†Œê°œ

|                                                  [ê¹€ë™í˜„](https://github.com/donghyyun)                                                   |                                                                          [ì„ì§€ì›](https://github.com/sophi1127)                                                                           |                                                 [ì´ìˆ˜ì—°](https://github.com/coding-groot)                                                  |                                                                        [ì§„ìƒìš°](https://github.com/Jin-s-work)                                                                         |                                                                         [ì‹¬ì¬ì •](https://github.com/Jaejeong98)                                                                         |
| :-------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------------------------: | :---------------------------------------------------------------------------------------------------------------------------------------------------: | :----------------------------------------------------------------------------------------------------------------------------------------------------: |
| ![á„€á…³á„…á…µá†·1](https://user-images.githubusercontent.com/61958748/172278471-584ffaf5-ea6d-4e63-ae77-7cac4dbae899.png)| ![á„€á…³á„…á…µá†·2](https://user-images.githubusercontent.com/61958748/172278474-f2d54e27-898b-4142-af78-b0e370e43ffc.png)| <img width="140" alt="á„€á…³á„…á…µá†·3" src="https://user-images.githubusercontent.com/61958748/172278478-f3bbd8ce-3616-4c37-8fa6-4247e20b469e.png">| ![á„€á…³á„…á…µá†·4](https://user-images.githubusercontent.com/61958748/172278482-a591c2e4-f4b7-4edf-a390-9e875c2c4226.png)| ![á„€á…³á„…á…µá†·5](https://user-images.githubusercontent.com/61958748/172278489-00773bd6-080f-41ec-b828-24f4dabc5f98.png)|    
<br/>

## âœ¨Contribution

- [`ê¹€ë™í˜„`](https://github.com/donghyyun) &nbsp; MF model â€¢ RecVAE

- [`ì„ì§€ì›`](https://github.com/sophi1127) &nbsp; lightFM â€¢ DeepCTR â€¢ DeepFM

- [`ì´ìˆ˜ì—°`](https://github.com/coding-groot) &nbsp; DeepFM â€¢ Ensemble(hard voting)

- [`ì§„ìƒìš°`](https://github.com/Jin-s-work) &nbsp; SASRec â€¢ SSE-PT   

- [`ì‹¬ì¬ì •`](https://github.com/Jaejeong98) &nbsp; SAR â€¢ Bert4Rec â€¢ Ensemble(hard voting)

<br/>

## About Project
![image](https://user-images.githubusercontent.com/61958748/172305015-db2c7c4d-b457-412e-8c39-0e46f7037ef8.png)   
<br/>

### ì‚¬ìš©ìì˜ ì˜í™” ì‹œì²­ ì´ë ¥ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‚¬ìš©ìê°€ ë‹¤ìŒì— ì‹œì²­í•  ì˜í™” ë° ì¢‹ì•„í•  ì˜í™”ë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆëŠ”ê°€? 
- `Timestamp`ë¥¼ ê³ ë ¤í•œ ì‚¬ìš©ìì˜ ìˆœì°¨ì ì¸ ì´ë ¥ì„ ê³ ë ¤í•˜ê³  `Implicit feedback`ì„ ê³ ë ¤.      
- `Implicit feedback` ê¸°ë°˜ì˜ `Sequential recommendation` ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‚¬ìš©ìì˜ `Time-ordered sequence`ì—ì„œ ì¼ë¶€ `item`ì´ ëˆ„ë½ëœ (dropout) ëœ ìƒí™©ì„ ìƒì •.      
- ì—¬ëŸ¬ ê°€ì§€ ì•„ì´í…œ(ì˜í™”)ê³¼ ê´€ë ¨ëœ `content(side-information)`ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í™œìš©.     
<br/>

### í‰ê°€ ì§€í‘œ
<img width="824" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-07 á„‹á…©á„’á…® 2 53 09" src="https://user-images.githubusercontent.com/61958748/172305842-0a241881-bac8-428d-b415-8b6f68639a6d.png">

- submisison íŒŒì¼(csv í˜•íƒœ)ì— `Training Data`ì— ì¡´ì¬í•˜ëŠ” ì „ì²´ ìœ ì €ë“¤ì— ëŒ€í•´ì„œ ê°ê° 10ê°œì˜ ì•„ì´í…œì„ ì¶”ì²œ.     
- ì‚¬ì „ì— MovieLens ë°ì´í„°ì—ì„œ ì¶”ì¶œí•´ë†“ì€ `ground-truth` ì•„ì´í…œë“¤ì„ ê³ ë ¤í•˜ì—¬ ìœ„ì˜ ìˆ˜ì‹ê³¼ ê°™ì´ `Recall@10`ì„ ê³„ì‚°.     
<br/>

## ë°ì´í„°

| íŒŒì¼      |   ë‚´ìš©     |
| -------- | --------- |
| train_ratings.csv | ì£¼ í•™ìŠµ ë°ì´í„°, `userid`, `itemid`, `timestamp`(ì´ˆ)ë¡œ êµ¬ì„±(5,154,471í–‰)|
| Ml_item2attributes.json     |   ì „ì²˜ë¦¬ì— ì˜í•´ ìƒì„±ëœ ë°ì´í„°(`item`ê³¼ `genre`ì˜ mapping ë°ì´í„°)      |
| titles.tsv | ì˜í™” ì œëª©(6,807í–‰) |
| years.tsv | ì˜í™” ê°œë´‰ë…„ë„(6,799í–‰) |
| directors.tsv | ì˜í™”ë³„ ê°ë…(5,905í–‰) |
| genres.tsv | ì˜í™” ì¥ë¥´ (í•œ ì˜í™”ì— ì—¬ëŸ¬ ì¥ë¥´ê°€ í¬í•¨ë  ìˆ˜ ìˆë‹¤, 15,934í–‰) |
| writers.tsv | ì˜í™” ì‘ê°€ (11,307í–‰) |   
<br/>


## EDA & Feature Engineering & í•™ìŠµë°ì´í„° ì†Œê°œ
1. user11ì˜ ì˜ˆì‹œë¥¼ í†µí•œ ë°ì´í„° ì´í•´ <br/>
<img width="523" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-07 á„‹á…©á„’á…® 3 09 26" src="https://user-images.githubusercontent.com/61958748/172308049-6db66451-ad02-41a1-966c-128ee7a15e52.png">    <br/>
- 376ê°œì˜ `ë¦¬ë·°` ì‘ì„±. (375ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ ì˜í™” ë¦¬ë·° ì‘ì„±)   
- ë¦¬ë·° ì‘ì„± ë‚ ì§œ 5ì¼ : `ì£¼ì–´ì§„ ë°ì´í„°ê°€ Sequential ë°ì´í„°ì¸ì§€ ì˜ë¬¸?` <br/>
'2009-01-01' (248ê°œ), '2009-01-02' (66ê°œ), '2009-08-24' (13ê°œ), '2009-08-25' (36ê°œ), '2011-01-12â€™ (13ê°œ).

2. userë³„ë¡œ ë‚¨ê¸´ ì˜í™”ì˜ ê°œìˆ˜ì™€ ë¦¬ë·°ë¥¼ ë‚¨ê¸´ ë‚ ì§œ ì‚¬ì´ì˜ ê´€ê³„ í™•ì¸ì„ í†µí•œ Sequential data íŒë‹¨ <br/>
<img width="713" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-07 á„‹á…©á„’á…® 3 15 27" src="https://user-images.githubusercontent.com/61958748/172308904-39248379-e582-40d7-b257-899c1a282801.png">   <br/>
- 1ì¼ í‰ê·  ìµœì†Œ 1ê°œ, ìµœëŒ€ 1,795ê°œ, í‰ê·  54ê°œì˜ ì˜í™” ë¦¬ë·°ë¥¼ ë‚¨ê¹€.
- userê°€ ì˜í™”ë¥¼ ë³¼ ë•Œë§ˆë‹¤ ë¦¬ë·°ë¥¼ ë‚¨ê¸´ ê²ƒì´ ì•„ë‹ˆë¼ í•˜ë£¨ì— ëª°ì•„ì„œ ë¦¬ë·°ë¥¼ ë‚¨ê²¼ë‹¤ëŠ” íŒë‹¨.
- ì‹¤ì œë¡œ `Sequential ëª¨ë¸`ì„ ì‚¬ìš©í•  ë•Œë³´ë‹¤ `Static ëª¨ë¸`ì„ ì‚¬ìš©í•  ë•Œ ì„±ëŠ¥ì´ ë†’ê²Œ ë‚˜ì˜´.
<br/>


## Model
- __RecVAE__ : 
  - ê¸°ì¡´ `Multi-VAE`ì— ëª‡ ê°€ì§€ í…Œí¬ë‹‰ì„ ë”í•œ `collaborative filtering`ê¸°ë°˜ ëª¨ë¸. <br/>
  - ì œëª©ì— `implicit data` ê¸°ë°˜ `top-n recommendation` ë¬¸ì œì— ì í•©. <br/>
  - ì‹¤ì œ ëŒ€íšŒì—ì„œë„ ë‹¨ì¼ ëª¨ë¸ë¡œ ê°€ì¥ ë†’ì€ ì„±ëŠ¥ì¸ 0.1499ë¥¼ ë³´ì„. <br/>
- __lightFM__ : 
  - `implicit feedback`ê³¼ `explicit feedback`ì— ëª¨ë‘ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì•Œê³ ë¦¬ì¦˜. <br/>
  - `user`ì™€ `item`ì˜ ë©”íƒ€ë°ì´í„°(side information)ë¥¼ ê¸°ì¡´ì˜ `MF ì•Œê³ ë¦¬ì¦˜`ì— ê²°í•©í•˜ì—¬ ìƒˆë¡œìš´ í•­ëª©ê³¼ ìƒˆë¡œìš´ ì‚¬ìš©ìë¡œ ì¼ë°˜í™”í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì . <br/>
  - ì‹¤ì œë¡œ `side information`ì„ ì‚¬ìš©í–ˆì„ ë•Œ ì„±ëŠ¥ì´ ë‚®ì•„ì¡Œê¸° ë•Œë¬¸ì— ë©”íƒ€ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ. <br/>
- __SASRec__ : 
  - `Markov chain(MC)`ê³¼ `Recurrent Neural Network(RNN)`ì˜ ì¥ì ì„ ë°˜ì˜í•œ ëª¨ë¸. <br/>
  - `self-attentive`ë¥¼ í™œìš©í•œ `sequential recommender`ëª¨ë¸ì—ì„œ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ì •í•˜ì—¬ ì¼ë¶€ `sequential`í•œ íŠ¹ì§•ì„ ê°€ì§„ ë°ì´í„°ë¥¼ ëª¨ë¸ë§ í•˜ëŠ” ë°ì— ì‚¬ìš©. <br/>
<br/>

### Ensemble
- ëª¨ë¸ ê°ê°ì´ ê°€ì§€ê³  ìˆëŠ” ì¥ì ì„ ì‚´ë ¤ì„œ ì¢‹ì€ ê²°ê³¼ë¥¼ ë‚´ê¸° ìœ„í•´ `hard voting` ë°©ì‹ì„ í†µí•œ `ensemble`ì„ ì‹œë„.
- ë°©ì‹ : `recall@10` ê²°ê³¼ì— 3-4ê°€ì§€ ëª¨ë¸ì„ í™œìš©í•˜ì—¬ ë§ì´ ê²¹ì¹˜ëŠ” ê²ƒì„ ìš°ì„ ì ìœ¼ë¡œ ì¶”ì¶œí•œ ë’¤, ì„±ëŠ¥ì´ ì¢‹ì€ ëª¨ë¸ ìˆœìœ¼ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•˜ì—¬ ë‚˜ë¨¸ì§€ë¥¼ ì±„ì›€.
- ê°€ì¥ ì„±ëŠ¥ì´ ì˜ ë‚˜ì˜¨ `ensemble`ì€ `lightFM`ì—ì„œ recall@30, `recVAE`ì—ì„œ recall@30, `SASRec`ì—ì„œ recall@10ì„ ë½‘ì•„ `recVAE`>`lightFM`>`SASRec` ìˆœìœ¼ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•œ ë°©ì‹.
<br/>

## Result

<img width="766" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-07 á„‹á…©á„’á…® 3 29 22" src="https://user-images.githubusercontent.com/61958748/172311114-06ca8712-1438-4ecc-bc0c-53b2b407c5bc.png">

- [`lightFM` 30ê°œ, `RecVAE` 30ê°œ, `SASRec` 10ê°œ]ë¥¼ ë½‘ì•„ ë§ì´ ê²¹ì¹˜ëŠ” ê²ƒì„ ìš°ì„ ì ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ `RecVAE`, `lightFM`, `SASRec` ìˆœìœ¼ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•˜ì—¬ `Hard voting` : 0.1536 â†’ 0.1533. <br/>
- [`lightFM`, `RecVAE`, `SASRec`, `MultiVAE` 10ê°œì”©] ìœ¼ë¡œ êµ¬ì„±ëœ 4ê°œì˜ ëª¨ë¸ì„ `RecVAE`, `lightFM`, `MultiVAE`, `SASRec` ìˆœìœ¼ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•˜ì—¬ `Hard voting` : 0.1515 â†’ 0.1532. <br/>
- [`lightFM`, `MultiVAE`, `RecVAE`, `SASRec` 30ê°œì”©]ì„ ë½‘ì•„ `Soft-voting` : 0.1526 â†’ 0.1528. <br/>



